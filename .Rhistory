theme_bw()
JPRF_sf
statistics <- data_clean_1 %>%
select(site, sl:meandom_8) %>%
pivot_longer(cols = c(-site), names_to = "variable", values_to = "value") %>%
group_nest(variable) %>%
mutate(mean = map_dbl(.x = data, .f =~ .x %>% pull(value) %>% mean()),
sd = map_dbl(.x = data, .f =~ .x %>% pull(value) %>% sd()),
min = map_dbl(.x = data, .f =~ .x %>% pull(value) %>% min()),
max = map_dbl(.x = data, .f =~ .x %>% pull(value) %>% max()),
CV_group = map_dbl(.x = data, .f =~ sd(.x$value)/mean(.x$value)*100),
CV_individual = map_dbl(.x = data, .f =~ .x %>%
group_by(site) %>%
dplyr::summarise(CV = sd(value)/mean(value)) %>%
pull(CV) %>%
mean() *100),
ANOVA = map_dbl(.x = data, .f =~ .x %>%
lm(formula = value ~ site) %>%
anova() %>%
.$`Pr(>F)` %>%
.[1])) %>%
select(-data)
statistics
statistics %>% view()
test <- data_clean_1 %>%
select(site, sl:meandom_8) %>%
pivot_longer(cols = c(-site), names_to = "variable", values_to = "value") %>%
group_nest(variable)
test
test
test <- data_clean_1 %>%
select(site, sl:meandom_8)
test
test <- data_clean_1 %>%
select(site, sl:meandom_8) %>%
pivot_longer(cols = c(-site), names_to = "variable", values_to = "value")
test
test <- data_clean_1 %>%
select(site, sl:meandom_8) %>%
pivot_longer(cols = c(-site), names_to = "variable", values_to = "value")
test
test <- data_clean_1 %>%
select(site, sl:meandom_8) %>%
pivot_longer(cols = c(-site), names_to = "variable", values_to = "value") %>%
group_nest(site)
test
test
test$data[[1]]
test1 <- test$data[[1]] %>%
group_by(variable)
test1
test1 <- test$data[[1]] %>%
group_by(variable) %>%
summarize(n = n(), mean = mean(value))
test1
test1 <- test$data[[1]] %>%
group_by(variable) %>%
summarize(n = n(), mean = mean(value), sd = sd(value), min = min(value), max = max(value))
test1
test <- data_clean_1 %>%
select(site, sl:meandom_8) %>%
pivot_longer(cols = c(-site), names_to = "variable", values_to = "value") %>%
group_nest(site) %>%
mutate(stats = map(.x = data, .f =~ .x %>%
group_by(variable) %>%
summarize(n = n(), mean = mean(value), sd = sd(value), min = min(value), max = max(value))))
test
test$stats[[1]]
test$stats[[2]]
test$stats[[10]]
test <- data_clean_1 %>%
select(site, sl:meandom_8) %>%
pivot_longer(cols = c(-site), names_to = "variable", values_to = "value") %>%
group_nest(site) %>%
mutate(stats = map(.x = data, .f =~ .x %>%
group_by(variable) %>%
summarize(n = n(),
mean = mean(value),
sd = sd(value),
min = min(value),
max = max(value),
CV = sd/mean)))
test
test
?unnest()
test <- data_clean_1 %>%
select(site, sl:meandom_8) %>%
pivot_longer(cols = c(-site), names_to = "variable", values_to = "value") %>%
group_nest(site) %>%
mutate(stats = map(.x = data, .f =~ .x %>%
group_by(variable) %>%
summarize(n = n(),
mean = mean(value),
sd = sd(value),
min = min(value),
max = max(value),
CV = sd/mean))) %>%
unnest(cols = c(site, stats))
test
test
test <- data_clean_1 %>%
select(site, sl:meandom_8) %>%
pivot_longer(cols = c(-site), names_to = "variable", values_to = "value") %>%
group_nest(site) %>%
mutate(stats = map(.x = data, .f =~ .x %>%
group_by(variable) %>%
summarize(n = n(),
mean = mean(value),
sd = sd(value),
min = min(value),
max = max(value),
CV = sd/mean))) %>%
select(-data) %>%
unnest(cols = c(site, stats))
test
test %>% view()
library(heplots)
data_clean_1
colnames(data_clean_1)
data_clean_1 %>%
select(site, sl:meandom_8)
epochdat.boxm <- data_clean_1 %>%
select(site, sl:meandom_8) %>%
boxM(.[, sl:meandom_8], .[, site])
epochdat.boxm <- data_clean_1 %>%
select(site, sl:meandom_8)
epochdat.boxm <- data_clean_1 %>%
select(site, sl:meandom_8) %>%
boxM(sl:meandom_8, .[, site])
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(tidyverse)
library(lubridate)
library(reshape2)
library(sf)
library(leaflet)
library(ggmap)
library(ggspatial)
library(ggord)
library(factoextra)
library(ggbiplot)
library(corrplot)
library(psych)
library(caret)
library(MASS)
library(klaR)
library(heplots)
here <- here::here
select <- dplyr::select
filter <- dplyr::filter
summarize <- dplyr::summarize
group_by <- dplyr::group_by
rename <- dplyr::rename
statistics
print(statistics)
view(statistics)
data_clean_1 %>%
select(site, sl:meandom_8) %>%
pivot_longer(cols = c(-site), names_to = "variable", values_to = "value") %>%
group_nest(variable)
test <- Spatial Distance and Vocal Similarity
test <- data_clean_1 %>%
select(site, sl:meandom_8) %>%
pivot_longer(cols = c(-site), names_to = "variable", values_to = "value") %>%
group_nest(variable)
test
test$data[[1]]
here()
write_csv(statistics, here("data", "barred_owl_parameters_statistics.csv"))
vocal_spatial
ggplot(aes(x = dist_spatial, y = dist_vocal), data = vocal_spatial_pair) +
geom_point(shape = 18, size = 4, colour = "red") +
geom_smooth(method = "lm", colour = "black") +
xlab("Distance between sites") +
ylab("Vocal similarity") +
stat_cor(method = "pearson", label.x = 0.2, label.y = 8.5, size = 5) +
theme_bw() +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12))
vocal_spatial <- cbind(data_transformed, predict(model)$x) %>%
group_by(individual) %>%
summarize(LD1_mean = mean(LD1),
LD2_mean = mean(LD2)) %>%
mutate(individual = str_sub(individual, start = 6)) %>%
left_join(data_location_clean, by = c("individual" = "site"))
vocal_spatial_pair <- tibble(dist_vocal = dist(vocal_spatial %>% select(LD1_mean, LD2_mean),
method = "euclidean") %>% c(),
dist_spatial = dist(vocal_spatial %>% select(longitude, latitude),
method = "euclidean") %>% c())
ggplot(aes(x = dist_spatial, y = dist_vocal), data = vocal_spatial_pair) +
geom_point(shape = 18, size = 4, colour = "red") +
geom_smooth(method = "lm", colour = "black") +
xlab("Distance between sites") +
ylab("Vocal similarity") +
stat_cor(method = "pearson", label.x = 0.2, label.y = 8.5, size = 5) +
theme_bw() +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12))
install.packages("ggpubr")
library(ggpubr)
ggplot(aes(x = dist_spatial, y = dist_vocal), data = vocal_spatial_pair) +
geom_point(shape = 18, size = 4, colour = "red") +
geom_smooth(method = "lm", colour = "black") +
xlab("Distance between sites") +
ylab("Vocal similarity") +
stat_cor(method = "pearson", label.x = 0.2, label.y = 8.5, size = 5) +
theme_bw() +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12))
ggplot(aes(x = dist_spatial, y = dist_vocal), data = vocal_spatial_pair) +
geom_point(shape = 18, size = 4, colour = "black") +
geom_smooth(method = "lm", colour = "black") +
xlab("Distance between sites") +
ylab("Vocal similarity") +
stat_cor(method = "pearson", label.x = 0.2, label.y = 8.5, size = 5) +
theme_bw() +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12))
ggplot(aes(x = dist_spatial, y = dist_vocal), data = vocal_spatial_pair) +
geom_point(shape = 9, size = 4, colour = "black") +
geom_smooth(method = "lm", colour = "black") +
xlab("Distance between sites") +
ylab("Vocal similarity") +
stat_cor(method = "pearson", label.x = 0.2, label.y = 8.5, size = 5) +
theme_bw() +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12))
ggplot(aes(x = dist_spatial, y = dist_vocal), data = vocal_spatial_pair) +
geom_point(shape = 10, size = 4, colour = "black") +
geom_smooth(method = "lm", colour = "black") +
xlab("Distance between sites") +
ylab("Vocal similarity") +
stat_cor(method = "pearson", label.x = 0.2, label.y = 8.5, size = 5) +
theme_bw() +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12))
ggplot(aes(x = dist_spatial, y = dist_vocal), data = vocal_spatial_pair) +
geom_point(shape = 12, size = 4, colour = "black") +
geom_smooth(method = "lm", colour = "black") +
xlab("Distance between sites") +
ylab("Vocal similarity") +
stat_cor(method = "pearson", label.x = 0.2, label.y = 8.5, size = 5) +
theme_bw() +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12))
ggplot(aes(x = dist_spatial, y = dist_vocal), data = vocal_spatial_pair) +
geom_point(shape = 18, size = 4, colour = "black") +
geom_smooth(method = "lm", colour = "black") +
xlab("Distance between sites") +
ylab("Vocal similarity") +
stat_cor(method = "pearson", label.x = 0.2, label.y = 8.5, size = 5) +
theme_bw() +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12))
ggplot(aes(x = dist_spatial, y = dist_vocal), data = vocal_spatial_pair) +
geom_point(shape = 18, size = 4, colour = "black") +
geom_smooth(method = "lm", colour = "black") +
xlab("Distance between sites") +
ylab("Vocal similarity") +
stat_cor(method = "pearson", label.x = 0.2, label.y = 8.5, size = 5) +
theme_bw() +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12))
acc_kappa_p
variables <- c("sl", "i2", "i3", "duration_8", "meandom_6",
"duration_3", "meandom_8", "duration_2", "meandom_5", "meandom_1")
data_transformed <- data_clean_1 %>%
preProcess(method = c("center", "scale")) %>%
predict(data_clean_1) %>%
select(all_of(c("individual", variables[1:6])))
model <- data_transformed %>%
lda(individual ~ ., data = .)
# lda_data <- cbind(data_transformed, predict(model)$x)
# ggplot(lda_data, aes(LD1, LD2)) +
#   geom_point(aes(color = individual))
ggord(model, data_clean_1$site, arrow = NULL, txt = NULL) +
coord_fixed(ratio = 0.7)
variables <- c("sl", "i2", "i3", "duration_8", "meandom_6",
"duration_3", "meandom_8", "duration_2", "meandom_5", "meandom_1")
data_transformed <- data_clean_1 %>%
preProcess(method = c("center", "scale")) %>%
predict(data_clean_1) %>%
select(all_of(c("individual", variables[1:6])))
model <- data_transformed %>%
lda(individual ~ ., data = .)
# lda_data <- cbind(data_transformed, predict(model)$x)
# ggplot(lda_data, aes(LD1, LD2)) +
#   geom_point(aes(color = individual))
ggord(model, data_clean_1$site, arrow = NULL, txt = NULL) +
coord_fixed(ratio = 0.7)
variables <- c("sl", "i2", "i3", "duration_8", "meandom_6",
"duration_3", "meandom_8", "duration_2", "meandom_5", "meandom_1")
data_transformed <- data_clean_1 %>%
preProcess(method = c("center", "scale")) %>%
predict(data_clean_1) %>%
select(all_of(c("individual", variables[1:6])))
model <- data_transformed %>%
lda(individual ~ ., data = .)
# lda_data <- cbind(data_transformed, predict(model)$x)
# ggplot(lda_data, aes(LD1, LD2)) +
#   geom_point(aes(color = individual))
ggord(model, data_clean_1$site, arrow = NULL, txt = NULL) +
coord_fixed(ratio = 0.7)
df <- melt(cm_p_6[[1]]$table) %>%
mutate(value = round(value))
# colnames(df) <- c("x", "y", "value")
ggplot(df, aes(x = predicted, y = observed, fill = value  %>% log())) +
geom_tile(color = "gray90",
lwd = 1.5,
linetype = 1) +
scale_fill_gradient(low = "white", high = "red", na.value = "white") +
coord_fixed() +
theme(axis.text.x = element_text(angle = 60, vjust = 0.1, hjust = 0.2))
df <- melt(cm_p_6[[1]]$table) %>%
mutate(value = round(value))
# colnames(df) <- c("x", "y", "value")
ggplot(df, aes(x = predicted, y = observed, fill = value  %>% log())) +
geom_tile(color = "gray90",
lwd = 1.5,
linetype = 1) +
scale_fill_gradient(low = "white", high = "red", na.value = "white") +
coord_fixed() +
theme(axis.text.x = element_text(angle = 60, vjust = 0.1, hjust = 0.2))
cm_p_6[[1]]$table
std <- function(x) sd(x)/sqrt(length(x))
acc_kappa_p <- bind_cols(cm_p_1[[2]], cm_p_2[[2]], cm_p_3[[2]], cm_p_4[[2]], cm_p_5[[2]],
cm_p_6[[2]], cm_p_7[[2]], cm_p_8[[2]], cm_p_9[[2]], cm_p_10[[2]],
cm_p_1[[3]], cm_p_2[[3]], cm_p_3[[3]], cm_p_4[[3]], cm_p_5[[3]],
cm_p_6[[3]], cm_p_7[[3]], cm_p_8[[3]], cm_p_9[[3]], cm_p_10[[3]]) %>%
rename(!!setNames(names(.), c(paste0("Accuracy_", seq(1:10)), paste0("Kappa Statistics_", seq(1:10))))) %>%
pivot_longer(everything(), names_to = "method", values_to = "value") %>%
separate(col = method, sep = "_", into = c("metrics", "n_variables")) %>%
mutate(n_variables = factor(n_variables, levels = unique(n_variables))) %>%
# ggplot(aes(x = n_variables, y = value)) +
# geom_boxplot() +
# geom_jitter(color = "steelblue",
#             size = 0.9,
#             position = position_jitter(width = 0.15),
#             alpha = 0.3) +
# facet_wrap(~metrics, nrow = 1) +
# theme_bw()
group_by(metrics, n_variables) %>%
summarize(mean_value = mean(value),
std_value = std(value)) %>%
ungroup() %>%
ggplot(aes(x = n_variables, y = mean_value,
colour = metrics, group = metrics)) +
#geom_point(size = 5, shape = 1) +
geom_ribbon(aes(ymin = mean_value - 1.96*std_value,
ymax = mean_value + 1.96*std_value),
alpha = 0.3, colour = NA) +
geom_line(size = 1.2) +
scale_colour_viridis_d() +
xlab("Number of variables") +
ylab("Value") +
theme_bw() +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 14),
legend.position = c(0.8, 0.2))
acc_kappa_p
acc_kappa_p
summarise <- dplyr::summarise()
here <- here::here
select <- dplyr::select
filter <- dplyr::filter
summarize <- dplyr::summarize
summarise <- dplyr::summarise
group_by <- dplyr::group_by
rename <- dplyr::rename
std <- function(x) sd(x)/sqrt(length(x))
acc_kappa_p <- bind_cols(cm_p_1[[2]], cm_p_2[[2]], cm_p_3[[2]], cm_p_4[[2]], cm_p_5[[2]],
cm_p_6[[2]], cm_p_7[[2]], cm_p_8[[2]], cm_p_9[[2]], cm_p_10[[2]],
cm_p_1[[3]], cm_p_2[[3]], cm_p_3[[3]], cm_p_4[[3]], cm_p_5[[3]],
cm_p_6[[3]], cm_p_7[[3]], cm_p_8[[3]], cm_p_9[[3]], cm_p_10[[3]]) %>%
rename(!!setNames(names(.), c(paste0("Accuracy_", seq(1:10)), paste0("Kappa Statistics_", seq(1:10))))) %>%
pivot_longer(everything(), names_to = "method", values_to = "value") %>%
separate(col = method, sep = "_", into = c("metrics", "n_variables")) %>%
mutate(n_variables = factor(n_variables, levels = unique(n_variables))) %>%
# ggplot(aes(x = n_variables, y = value)) +
# geom_boxplot() +
# geom_jitter(color = "steelblue",
#             size = 0.9,
#             position = position_jitter(width = 0.15),
#             alpha = 0.3) +
# facet_wrap(~metrics, nrow = 1) +
# theme_bw()
group_by(metrics, n_variables) %>%
summarize(mean_value = mean(value),
std_value = std(value)) %>%
ungroup() %>%
ggplot(aes(x = n_variables, y = mean_value,
colour = metrics, group = metrics)) +
#geom_point(size = 5, shape = 1) +
geom_ribbon(aes(ymin = mean_value - 1.96*std_value,
ymax = mean_value + 1.96*std_value),
alpha = 0.3, colour = NA) +
geom_line(size = 1.2) +
scale_colour_viridis_d() +
xlab("Number of variables") +
ylab("Value") +
theme_bw() +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 14),
legend.position = c(0.8, 0.2))
acc_kappa_p
acc_kappa_p
std <- function(x) sd(x)/sqrt(length(x))
acc_kappa_p <- bind_cols(cm_p_1[[2]], cm_p_2[[2]], cm_p_3[[2]], cm_p_4[[2]], cm_p_5[[2]],
cm_p_6[[2]], cm_p_7[[2]], cm_p_8[[2]], cm_p_9[[2]], cm_p_10[[2]],
cm_p_1[[3]], cm_p_2[[3]], cm_p_3[[3]], cm_p_4[[3]], cm_p_5[[3]],
cm_p_6[[3]], cm_p_7[[3]], cm_p_8[[3]], cm_p_9[[3]], cm_p_10[[3]]) %>%
rename(!!setNames(names(.), c(paste0("Accuracy_", seq(1:10)), paste0("Kappa Statistics_", seq(1:10))))) %>%
pivot_longer(everything(), names_to = "method", values_to = "value") %>%
separate(col = method, sep = "_", into = c("metrics", "n_variables")) %>%
mutate(n_variables = factor(n_variables, levels = unique(n_variables))) %>%
# ggplot(aes(x = n_variables, y = value)) +
# geom_boxplot() +
# geom_jitter(color = "steelblue",
#             size = 0.9,
#             position = position_jitter(width = 0.15),
#             alpha = 0.3) +
# facet_wrap(~metrics, nrow = 1) +
# theme_bw()
group_by(metrics, n_variables) %>%
summarize(mean_value = mean(value),
std_value = std(value)) %>%
ungroup() %>%
ggplot(aes(x = n_variables, y = mean_value,
colour = metrics, group = metrics)) +
#geom_point(size = 5, shape = 1) +
geom_ribbon(aes(ymin = mean_value - 1.96*std_value,
ymax = mean_value + 1.96*std_value),
alpha = 0.3) +
geom_line(size = 1.2) +
scale_colour_viridis_d() +
xlab("Number of variables") +
ylab("Value") +
theme_bw() +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 14),
legend.position = c(0.8, 0.2))
acc_kappa_p
acc_kappa_p
std <- function(x) sd(x)/sqrt(length(x))
acc_kappa_p <- bind_cols(cm_p_1[[2]], cm_p_2[[2]], cm_p_3[[2]], cm_p_4[[2]], cm_p_5[[2]],
cm_p_6[[2]], cm_p_7[[2]], cm_p_8[[2]], cm_p_9[[2]], cm_p_10[[2]],
cm_p_1[[3]], cm_p_2[[3]], cm_p_3[[3]], cm_p_4[[3]], cm_p_5[[3]],
cm_p_6[[3]], cm_p_7[[3]], cm_p_8[[3]], cm_p_9[[3]], cm_p_10[[3]]) %>%
rename(!!setNames(names(.), c(paste0("Accuracy_", seq(1:10)), paste0("Kappa Statistics_", seq(1:10))))) %>%
pivot_longer(everything(), names_to = "method", values_to = "value") %>%
separate(col = method, sep = "_", into = c("metrics", "n_variables")) %>%
mutate(n_variables = factor(n_variables, levels = unique(n_variables))) %>%
# ggplot(aes(x = n_variables, y = value)) +
# geom_boxplot() +
# geom_jitter(color = "steelblue",
#             size = 0.9,
#             position = position_jitter(width = 0.15),
#             alpha = 0.3) +
# facet_wrap(~metrics, nrow = 1) +
# theme_bw()
group_by(metrics, n_variables) %>%
summarize(mean_value = mean(value),
std_value = std(value)) %>%
ungroup() %>%
ggplot(aes(x = n_variables, y = mean_value,
colour = metrics, group = metrics)) +
#geom_point(size = 5, shape = 1) +
geom_ribbon(aes(ymin = mean_value - 1.96*std_value,
ymax = mean_value + 1.96*std_value),
alpha = 0.3, colour = NA) +
geom_line(size = 1.2) +
scale_colour_viridis_d() +
xlab("Number of variables") +
ylab("Value") +
theme_bw() +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 14),
legend.position = c(0.8, 0.2))
acc_kappa_p
acc_kappa_p <- bind_cols(cm_p_1[[2]], cm_p_2[[2]], cm_p_3[[2]], cm_p_4[[2]], cm_p_5[[2]],
cm_p_6[[2]], cm_p_7[[2]], cm_p_8[[2]], cm_p_9[[2]], cm_p_10[[2]],
cm_p_1[[3]], cm_p_2[[3]], cm_p_3[[3]], cm_p_4[[3]], cm_p_5[[3]],
cm_p_6[[3]], cm_p_7[[3]], cm_p_8[[3]], cm_p_9[[3]], cm_p_10[[3]]) %>%
rename(!!setNames(names(.), c(paste0("Accuracy_", seq(1:10)), paste0("Kappa Statistics_", seq(1:10))))) %>%
pivot_longer(everything(), names_to = "method", values_to = "value") %>%
separate(col = method, sep = "_", into = c("metrics", "n_variables")) %>%
mutate(n_variables = factor(n_variables, levels = unique(n_variables))) %>%
# ggplot(aes(x = n_variables, y = value)) +
# geom_boxplot() +
# geom_jitter(color = "steelblue",
#             size = 0.9,
#             position = position_jitter(width = 0.15),
#             alpha = 0.3) +
# facet_wrap(~metrics, nrow = 1) +
# theme_bw()
group_by(metrics, n_variables) %>%
summarize(mean_value = mean(value),
std_value = std(value)) %>%
ungroup()
acc_kappa_p
ggord(model, data_clean_1$site, arrow = NULL, txt = NULL) +
coord_fixed(ratio = 0.7)
ggord(model, data_clean_1$site, arrow = NULL, txt = NULL) +
coord_fixed(ratio = 0.7)
